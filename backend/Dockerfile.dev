FROM mcr.microsoft.com/dotnet/sdk:9.0

WORKDIR /src

# Copy solution file
COPY *.sln .

# Copy project file
COPY backend/Api/*.csproj backend/Api/

# Restore dependencies
RUN dotnet restore backend/Api/Api.csproj

# Copy source code (this will be overridden by volume mount for development)
COPY . .

WORKDIR /src/backend/Api

# Expose port
EXPOSE 8080

# Install dotnet-watch for hot reloading
RUN dotnet tool install --global dotnet-watch

# Start development server with hot reload
CMD ["dotnet", "watch", "run", "--urls", "http://0.0.0.0:8080"]